--LITERALS

USE TSQLV3;
SELECT orderid, custid, empid, orderdate
FROM Sales.Orders
WHERE orderdate = '02/12/2015';


--IDENTIFY WEEKDAYS

SET DATEFIRST = 1

SELECT DATEPART(WEEKDAY, SYSDATETIME());


SELECT DATEDIFF(DAY, '19000101', SYSDATETIME())%7 +1;


SELECT DATEPART(weekday, DATEADD(day, @@DATEFIRST - 1, SYSDATETIME()));

SELECT CAST(CAST(SYSDATETIME() AS date) AS date)

SELECT DATEADD(day, DATEDIFF(day, '19000101', SYSDATETIME()), '19000101');

--FIRST LAST PREVIOUS AND NEXT DATE CALCULATION 

SELECT DATEADD(DAY, DATEDIFF(DAY, '19000101', SYSDATETIME()), '19000101')

SELECT DATEADD(MONTH, DATEDIFF(MONTH, '19000101', SYSDATETIME()), '19000101')


SELECT DATEADD(
day,
DATEDIFF(
day,
'19000101', -- Base Monday date
SYSDATETIME()) /7*7,
'19000101'); -- Base Monday date

SELECT DATEADD(day, DATEDIFF(day, '19000101', DATEADD(day, -1, SYSDATETIME()))
/7*7 + 7,
'19000101');


SELECT DATEADD(day, DATEDIFF(day, '19000102',
-- last day of year
DATEADD(year, DATEDIFF(year, '18991231', SYSDATETIME()), '18991231')
) /7*7, '19000102');


USE PerformanceV3;
SELECT orderid, orderdate, filler
FROM dbo.Orders
WHERE YEAR(orderdate) = 2014;
SELECT orderid, orderdate, filler
FROM dbo.Orders
WHERE orderdate >= '20140101'
AND orderdate < '20150101';


--PG 565